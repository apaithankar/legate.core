# SPDX-FileCopyrightText: Copyright (c) 2023 NVIDIA CORPORATION & AFFILIATES.
#                         All rights reserved.
# SPDX-License-Identifier: LicenseRef-NvidiaProprietary
#
# NVIDIA CORPORATION, its affiliates and licensors retain all intellectual
# property and proprietary rights in and to this material, related
# documentation and any modifications thereto. Any use, reproduction,
# disclosure or distribution of this material and related documentation
# without an express license agreement from NVIDIA CORPORATION or
# its affiliates is strictly prohibited.

from typing import TYPE_CHECKING, Iterable

if TYPE_CHECKING:
    from ...data_interface import Field, LegateDataInterfaceItem
    from ..type.type_info import Type
    from .physical_store import PhysicalStore
    from .shape import Shape

class LogicalStore:
    @property
    def shape(self) -> Shape: ...
    @property
    def ndim(self) -> int: ...
    @property
    def has_scalar_storage(self) -> bool: ...
    def overlaps(self, other: LogicalStore) -> bool: ...
    @property
    def type(self) -> Type: ...
    @property
    def extents(self) -> list[int]: ...
    @property
    def volume(self) -> int: ...
    @property
    def size(self) -> int: ...
    @property
    def unbound(self) -> int: ...
    @property
    def transformed(self) -> bool: ...
    @property
    def __legate_data_interface__(self) -> LegateDataInterfaceItem: ...
    def __str__(self) -> str: ...
    def promote(self, extra_dim: int, dim_size: int) -> LogicalStore: ...
    def project(self, dim: int, index: int) -> LogicalStore: ...
    def slice(self, dim: int, sl: slice) -> LogicalStore: ...
    def transpose(self, axes: Iterable[int]) -> LogicalStore: ...
    def delinearize(self, dim: int, shape: Iterable[int]) -> LogicalStore: ...
    def partition_by_tiling(
        self, shape: Iterable[int]
    ) -> LogicalStorePartition: ...
    def get_physical_store(self) -> PhysicalStore: ...
    def detach(self) -> None: ...
    @property
    def raw_handle(self) -> int: ...

class LogicalStorePartition:
    @property
    def store(self) -> LogicalStore: ...
    @property
    def color_shape(self) -> list[int]: ...
    def get_child_store(self, *color: int) -> LogicalStore: ...
